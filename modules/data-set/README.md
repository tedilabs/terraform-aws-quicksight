# data-set

This module creates following resources.

- `aws_quicksight_data_set`
- `aws_quicksight_refresh_schedule` (optional)
- `aws_quicksight_ingestion` (optional)

<!-- BEGIN_TF_DOCS -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.12 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | >= 6.12 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_aws"></a> [aws](#provider\_aws) | 6.18.0 |

## Modules

| Name | Source | Version |
|------|--------|---------|
| <a name="module_resource_group"></a> [resource\_group](#module\_resource\_group) | tedilabs/misc/aws//modules/resource-group | ~> 0.12.0 |

## Resources

| Name | Type |
|------|------|
| [aws_quicksight_data_set.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/quicksight_data_set) | resource |
| [aws_quicksight_ingestion.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/quicksight_ingestion) | resource |
| [aws_quicksight_refresh_schedule.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/quicksight_refresh_schedule) | resource |
| [aws_caller_identity.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/caller_identity) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_name"></a> [name](#input\_name) | (Required) An identifier for the QuickSight data set. This ID is a unique identifier for each AWS Region in an AWS account. | `string` | n/a | yes |
| <a name="input_column_folders"></a> [column\_folders](#input\_column\_folders) | (Optional) A map of column folder configurations. Each entry represents a column folder (field folder) in the data set. A column folder is a logical grouping of columns that can be used to organize and categorize columns within the data set. Each key of `column_folders` is the folder name. `/` is used as a separator for subfolders. The folder name can be used to create a hierarchy of folders. Each value of `column_folders` as defined below.<br/>    (Optional) `columns` - A set of columns that belong to this folder. A column can only belong to one folder.<br/>    (Optional) `description` - A description for the column folder. Defaults to "Managed by Terraform." | <pre>map(object({<br/>    columns     = optional(set(string), [])<br/>    description = optional(string, "Managed by Terraform.")<br/>  }))</pre> | `{}` | no |
| <a name="input_column_level_permission_rules"></a> [column\_level\_permission\_rules](#input\_column\_level\_permission\_rules) | (Optional) A list of column-level permission rules. To create a restricted column, you add it to one or more rules. Each rule must contain at least one column and at least one user or group. To be able to see a restricted column, a user or group needs to be added to a rule for that column. Each rule specifies which columns are accessible to which principals. Each item of `column_level_permission_rules` as defined below.<br/>    (Required) `columns` - A set of column names that the rule applies to. At least one column must be specified.<br/>    (Required) `principals` - A set of ARNs (Amazon Resource Names) of the principals (users or groups) that this rule applies to. At least one principal must be specified. Maximum of 100 items. | <pre>list(object({<br/>    columns    = optional(set(string), [])<br/>    principals = optional(set(string), [])<br/>  }))</pre> | `[]` | no |
| <a name="input_data_set_usage"></a> [data\_set\_usage](#input\_data\_set\_usage) | (Optional) The usage configuration to apply to child datasets that reference this dataset as a source. `data_set_usage` as defined below.<br/>    (Optional) `use_as_direct_query_source` - Whether to enable the use of this data set as a direct query source. Defaults to `true`.<br/>    (Optional) `use_as_imported_source` - Whether to enable the use of this data set as an imported source. Defaults to `true`. | <pre>object({<br/>    use_as_direct_query_source = optional(bool, true)<br/>    use_as_imported_source     = optional(bool, true)<br/>  })</pre> | `{}` | no |
| <a name="input_display_name"></a> [display\_name](#input\_display\_name) | (Optional) The display name for the QuickSight data set. | `string` | `""` | no |
| <a name="input_geo_spatial_column_groups"></a> [geo\_spatial\_column\_groups](#input\_geo\_spatial\_column\_groups) | (Optional) A set of geographic column groups. A geo spatial column group is a logical grouping of two or more columns in the data set that together represent a geographical hierarchy, such as country, state, and city. This configuration allows QuickSight to recognize and use these columns as a spatial hierarchy for advanced geo-mapping and drill-down capabilities in visualizations. Each item of `geo_spatial_column_groups` as defined below.<br/>    (Required) `name` - A display name for the geographical hierarchy.<br/>    (Optional) `country_code` - The country code for the geographic column group. Valid values are ISO 3166-1 alpha-2 country codes like `US`.<br/>    (Required) `columns` - A list of columns that are part of the geographical hierarchy. | <pre>list(object({<br/>    name         = string<br/>    country_code = optional(string)<br/>    columns      = optional(list(string), [])<br/>  }))</pre> | `[]` | no |
| <a name="input_import_mode"></a> [import\_mode](#input\_import\_mode) | (Optional) Whether you want to import the data into SPICE. Valid values are `SPICE` and `DIRECT_QUERY`. Defaults to `SPICE`. | `string` | `"SPICE"` | no |
| <a name="input_logical_tables"></a> [logical\_tables](#input\_logical\_tables) | (Optional) A map of logical table configurations. Each entry represents a logical table with its configuration. A logical table is a unit that joins and that data transformations operate on. A logical table has a source, which can be either a physical table or result of a join operation. When a logical table points to a physical table, the logical table acts as a mutable copy of that physical table through transform operations. Each value of `logical_tables` as defined below.<br/>    (Required) `alias` - A display name for the logical table.<br/>    (Required) `source` - The source configuration for the logical table, which can be a physical table or a join instruction. `source` as defined below.<br/>      (Optional) `type` - The type of the source. Valid values are `PHYSICAL_TABLE`, `DATA_SET` and `JOIN`. Defaults to `PHYSICAL_TABLE`.<br/>      (Optional) `physical_table` - The ID of the physical table if the source type is `PHYSICAL_TABLE`.<br/>      (Optional) `data_set` - The ARN of the parent data set if the source type is `DATA_SET`.<br/>      (Optional) `join` - A join instruction if the source type is `JOIN`. `join` as defined below.<br/>        (Required) `left_operand` - The operand on the left side of the join. This can be a logical table id.<br/>        (Required) `right_operand` - The operand on the right side of the join. This can be a logical table id.<br/>        (Required) `type` - The type of the join. Valid values are `INNER`, `LEFT`, `RIGHT`, and `FULL`.<br/>        (Required) `on_clause` - The SQL expression that defines the `ON` clause of the join.<br/>        (Optional) `left_join_key_properties` - Properties for the left join key. `left_join_key_properties` as defined below.<br/>          (Optional) `unique_key` - Whether the left join key is unique. Defaults to `false`.<br/>        (Optional) `right_join_key_properties` - Properties for the right join key. `right_join_key_properties` as defined below.<br/>          (Optional) `unique_key` - Whether the right join key is unique. Defaults to `false`.<br/>    (Optional) `data_transforms` - A list of data transformation operations to apply to the logical table. Each item of `data_transforms` as defined below.<br/>      (Optional) `cast_column_type` - A transformation to cast a column to a new type. `cast_column_type` as defined below.<br/>        (Required) `column` - The name of the column to cast.<br/>        (Required) `new_type` - The new type to cast the column to. Valid values are `STRING`, `INTEGER`, `DECIMAL`, `DATETIME`, `BOOLEAN`, `BIT`, and `JSON`.<br/>        (Optional) `format` - The format string for date when casting a column from string to datetime type, you can supply a string in a format supported by Amazon QuickSight to denote the source data format.<br/>      (Optional) `create_columns` - A transformation to create new calculated columns. Columns created in one such operation form a lexical closure. `create_columns` as defined below.<br/>        (Required) `columns` - A list of calculated columns to create. Each item of `columns` as defined below.<br/>          (Required) `id` - The unique identifier for the calculated column.<br/>          (Required) `name` - The display name for the calculated column.<br/>          (Required) `expression` - An expression that defines the calculated column.<br/>      (Optional) `filter` - A transformation to filter rows based on a condition. `filter` as defined below.<br/>        (Required) `condition` - An expression that must evaluate to true for a row to be included in the logical table.<br/>      (Optional) `project` - A transformation to project specific columns. Operations that come after a projection can only refer to projected columns. `project` as defined below.<br/>        (Required) `columns` - A list of columns to include in the projection.<br/>      (Optional) `rename_column` - A transformation to rename a column. `rename_column` as defined below.<br/>        (Required) `column` - The name of the column to rename.<br/>        (Required) `new_name` - The new name for the column.<br/>      (Optional) `tag_column` - A transformation to tag a column with metadata. `tag_column` as defined below.<br/>        (Required) `column` - The name of the column to tag.<br/>        (Required) `tags` - A list of tags to apply to the column. Currently only used for geospatial type tagging. Each item of `tags` as defined below.<br/>          (Optional) `description` - A description for the tag. Defaults to "Managed by Terraform."<br/>          (Optional) `geographic_role` - The geographic role for the tag. Valid values are `COUNTRY`, `STATE`, `COUNTY`, `CITY`, `POSTCODE`, `LONGITUDE`, and `LATITUDE`.<br/>      (Optional) `untag_column` - A transformation to remove tags from a column. `untag_column` as defined below.<br/>        (Required) `column` - The name of the column from which to remove tags.<br/>        (Required) `tags` - A set of tags to remove from the column. | <pre>map(object({<br/>    alias = string<br/>    source = object({<br/>      type           = optional(string, "PHYSICAL_TABLE")<br/>      physical_table = optional(string)<br/>      data_set       = optional(string)<br/>      join = optional(object({<br/>        left_operand  = string<br/>        right_operand = string<br/>        type          = string<br/>        on_clause     = string<br/>        left_join_key_properties = optional(object({<br/>          unique_key = optional(bool, false)<br/>        }))<br/>        right_join_key_properties = optional(object({<br/>          unique_key = optional(bool, false)<br/>        }))<br/>      }))<br/>    })<br/>    data_transforms = optional(list(object({<br/>      cast_column_type = optional(object({<br/>        column   = string<br/>        new_type = string<br/>        format   = optional(string)<br/>      }))<br/>      create_columns = optional(object({<br/>        columns = list(object({<br/>          id         = string<br/>          name       = string<br/>          expression = string<br/>        }))<br/>      }))<br/>      filter = optional(object({<br/>        condition = string<br/>      }))<br/>      project = optional(object({<br/>        columns = list(string)<br/>      }))<br/>      rename_column = optional(object({<br/>        column   = string<br/>        new_name = string<br/>      }))<br/>      tag_column = optional(object({<br/>        column = string<br/>        tags = list(object({<br/>          description     = optional(string, "Managed by Terraform.")<br/>          geographic_role = optional(string)<br/>        }))<br/>      }))<br/>      untag_column = optional(object({<br/>        column = string<br/>        tags   = set(string)<br/>      }))<br/>    })), [])<br/>  }))</pre> | `{}` | no |
| <a name="input_module_tags_enabled"></a> [module\_tags\_enabled](#input\_module\_tags\_enabled) | (Optional) Whether to create AWS Resource Tags for the module informations. | `bool` | `true` | no |
| <a name="input_permissions"></a> [permissions](#input\_permissions) | (Optional) A list of resource permissions on the data set. Each item of `permissions` as defined below.<br/>    (Required) `principal` - The Amazon Resource Name (ARN) of the principal. This can be one of the following:<br/>      - The ARN of an Amazon QuickSight user or group associated with a data source or dataset. (This is common.)<br/>      - The ARN of an Amazon QuickSight user, group, or namespace associated with an analysis, dashboard, template, or theme. (This is common.)<br/>      - The ARN of an Amazon Web Services account root: This is an IAM ARN rather than a QuickSight ARN. Use this option only to share resources (templates) across Amazon Web Services accounts. (This is less common.)<br/>    (Optional) `role` - A role of principal with a pre-defined set of permissions. Valid values are `OWNER` and `USER`. Conflicting with `actions`.<br/>    (Optional) `actions` - A set of IAM actions to grant or revoke permissions on. Conflicting with `role`. | <pre>list(object({<br/>    principal = string<br/>    role      = optional(string)<br/>    actions   = optional(set(string), [])<br/>  }))</pre> | `[]` | no |
| <a name="input_physical_tables"></a> [physical\_tables](#input\_physical\_tables) | (Required) A map of physical table configurations. Each entry represents a physical table with its configuration. Each value of `physical_tables` as defined below.<br/>    (Required) `type` - The type of the physical table. Valid values are `S3`, `RELATIONAL_TABLE`, and `CUSTOM_SQL`.<br/>    (Required) `data_source` - The Amazon Resource Name (ARN) of the data source.<br/>    (Optional) `s3` - The configuration for the S3 source. Only required if `type` is `S3`. `s3` as defined below.<br/>      (Optional) `upload_settings` - The settings for uploading data from S3. `upload_settings` as defined below.<br/>        (Optional) `format` - The format of the data in S3. Valid values are `CSV`, `TSV`, `CLF`, `ELF`, `XLSX`, and `JSON`. Defaults to `CSV`.<br/>        (Optional) `starting_row` - The row number to start reading data from. Defaults to 1.<br/>        (Optional) `header_included` - Whether the first row contains column headers. Defaults to true.<br/>        (Optional) `delimiter` - The delimiter used in the data file. Defaults to a comma (`,`).<br/>        (Optional) `text_qualifier` - The text qualifier used in the data file. Valid values are `DOUBLE_QUOTE`, `SINGLE_QUOTE`. Defaults to `DOUBLE_QUOTE`.<br/>      (Required) `input_columns` - A list of input columns for the S3 source, each with a name and type.<br/>    (Optional) `relational_table` - The configuration for the relational table source. Only required if `type` is `RELATIONAL_TABLE`. `relational_table` as defined below.<br/>      (Optional) `catalog` - The catalog associated with the table.<br/>      (Optional) `schema` - The name of the schema. Only used on certain database engines.<br/>      (Required) `table` - The name of the table.<br/>      (Required) `input_columns` - A list of input columns for the relational table source, each with a name and type.<br/>    (Optional) `custom_sql` - The configuration for the custom SQL source. Only required if `type` is `CUSTOM_SQL`. `custom_sql` as defined below.<br/>      (Required) `name` - A display name for the SQL query result.<br/>      (Required) `sql_query` - The SQL query to execute.<br/>      (Required) `input_columns` - The column schema for the SQL query result set. | <pre>map(object({<br/>    type        = string<br/>    data_source = string<br/>    s3 = optional(object({<br/>      upload_settings = optional(object({<br/>        format          = optional(string, "CSV")<br/>        starting_row    = optional(number, 1)<br/>        header_included = optional(bool, true)<br/>        delimiter       = optional(string, ",")<br/>        text_qualifier  = optional(string, "DOUBLE_QUOTE")<br/>      }), {})<br/>      input_columns = list(object({<br/>        name = string<br/>        type = string<br/>      }))<br/>    }))<br/>    relational_table = optional(object({<br/>      catalog = optional(string)<br/>      schema  = optional(string)<br/>      table   = string<br/>      input_columns = list(object({<br/>        name = string<br/>        type = string<br/>      }))<br/>    }))<br/>    custom_sql = optional(object({<br/>      name      = string<br/>      sql_query = string<br/>      input_columns = optional(list(object({<br/>        name = string<br/>        type = string<br/>      })), [])<br/>    }))<br/>  }))</pre> | `{}` | no |
| <a name="input_refresh_config"></a> [refresh\_config](#input\_refresh\_config) | (Optional) A refresh configuration for the  data set. `refresh_config` as defined below.<br/>    (Optional) `incremental_refresh_lookback_window` - The configuration for the incremental refresh lookback window. This is used to determine how far back in time the incremental refresh should look for new or changed data. `incremental_refresh_lookback_window` as defined below.<br/>      (Required) `column` - The column that contains the timestamp or date information to use for the lookback window.<br/>      (Required) `size` - The size of the lookback window.<br/>      (Required) `unit` - The unit of time for the lookback window. Valid values are `HOUR`, `DAY`, and `WEEK`. | <pre>object({<br/>    incremental_refresh_lookback_window = optional(object({<br/>      column = string<br/>      size   = number<br/>      unit   = string<br/>    }))<br/>  })</pre> | `{}` | no |
| <a name="input_refresh_ingestions"></a> [refresh\_ingestions](#input\_refresh\_ingestions) | (Optional) A list of refresh ingestion configurations. Each item of `refresh_ingestions` as defined below.<br/>    (Required) `id` - The unique identifier for the refresh ingestion.<br/>    (Optional) `refresh_type` - The type of the refresh ingestion. Valid values are `INCREMENTAL` and `FULL`. Defaults to `FULL`. | <pre>list(object({<br/>    id           = string<br/>    refresh_type = optional(string, "FULL")<br/>  }))</pre> | `[]` | no |
| <a name="input_refresh_schedules"></a> [refresh\_schedules](#input\_refresh\_schedules) | (Optional) A list of refresh schedule configurations. Each item of `refresh_schedules` as defined below.<br/>    (Required) `id` - The unique identifier for the refresh schedule.<br/>    (Optional) `refresh_type` - The type of the refresh schedule. Valid values are `INCREMENTAL` and `FULL`. Defaults to `FULL`.<br/>    (Optional) `start_at` - The date and time after which the refresh schedule can be started, expressed in `YYYY-MM-DDTHH:MM:SS` format.<br/>    (Required) `schedule_frequency` - The configuration for the refresh schedule frequency. `schedule_frequency` as defined below.<br/>      (Optional) `timezone` - The timezone that you want the refresh schedule to use.<br/>      (Optional) `interval` - The interval at which the refresh should occur. Valid values are `MINUTE15`, `MINUTE30`, `HOURLY`, `DAILY`, `WEEKLY`, and `MONTHLY`. Defaults to `DAILY`.<br/>        - `MINUTE15` : The dataset refreshes every 15 minutes. This value is only supported for incremental refreshes. This interval can only be used for one schedule per dataset.<br/>        - `MINUTE30` : The dataset refreshes every 30 minutes. This value is only supported for incremental refreshes. This interval can only be used for one schedule per dataset.<br/>        - `HOURLY` : The dataset refreshes every hour. This interval can only be used for one schedule per dataset.<br/>        - `DAILY` : The dataset refreshes every day.<br/>        - `WEEKLY` : The dataset refreshes every week.<br/>        - `MONTHLY` : The dataset refreshes every month.<br/>      (Optional) `time_of_day` - The time of day that you want the dataset to refresh. This value is expressed in `HH:MM` format. This field is not required for schedules with `HOURLY` refresh type. Defaults to `00:00` (midnight).<br/>      (Optional) `day_of_week` - The day of the week on which the refresh should occur. Valid values are `SUNDAY`, `MONDAY`, `TUESDAY`, `WEDNESDAY`, `THURSDAY`, `FRIDAY`, and `SATURDAY`. Required if `interval` is set to `WEEKLY`.<br/>      (Optional) `day_of_month` - The day of the month on which the refresh should occur. Valid values are `1` to `28`, and `LAST_DAY_OF_MONTH`. Required if `interval` is set to `MONTHLY`. | <pre>list(object({<br/>    id           = string<br/>    refresh_type = optional(string, "FULL")<br/>    start_at     = optional(string)<br/>    schedule_frequency = object({<br/>      timezone     = optional(string)<br/>      interval     = optional(string, "DAILY")<br/>      time_of_day  = optional(string, "00:00")<br/>      day_of_week  = optional(string)<br/>      day_of_month = optional(string)<br/>    })<br/>  }))</pre> | `[]` | no |
| <a name="input_region"></a> [region](#input\_region) | (Optional) The region in which to create the module resources. If not provided, the module resources will be created in the provider's configured region. | `string` | `null` | no |
| <a name="input_resource_group"></a> [resource\_group](#input\_resource\_group) | (Optional) A configurations of Resource Group for this module. `resource_group` as defined below.<br/>    (Optional) `enabled` - Whether to create Resource Group to find and group AWS resources which are created by this module. Defaults to `true`.<br/>    (Optional) `name` - The name of Resource Group. A Resource Group name can have a maximum of 127 characters, including letters, numbers, hyphens, dots, and underscores. The name cannot start with `AWS` or `aws`. If not provided, a name will be generated using the module name and instance name.<br/>    (Optional) `description` - The description of Resource Group. Defaults to `Managed by Terraform.`. | <pre>object({<br/>    enabled     = optional(bool, true)<br/>    name        = optional(string, "")<br/>    description = optional(string, "Managed by Terraform.")<br/>  })</pre> | `{}` | no |
| <a name="input_row_level_permission_data_set"></a> [row\_level\_permission\_data\_set](#input\_row\_level\_permission\_data\_set) | (Optional) Configuration for row-level permission data set. | <pre>object({<br/>    arn               = string<br/>    permission_policy = string<br/>    format_version    = optional(string)<br/>    namespace         = optional(string)<br/>    status            = optional(string)<br/>  })</pre> | `null` | no |
| <a name="input_tags"></a> [tags](#input\_tags) | (Optional) A map of tags to add to all resources. | `map(string)` | `{}` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_arn"></a> [arn](#output\_arn) | The ARN of the data set. |
| <a name="output_column_folders"></a> [column\_folders](#output\_column\_folders) | A map of column folders in the data set. |
| <a name="output_column_level_permission_rules"></a> [column\_level\_permission\_rules](#output\_column\_level\_permission\_rules) | A list of column-level permission rules. |
| <a name="output_data_set_usage"></a> [data\_set\_usage](#output\_data\_set\_usage) | The usage configuration for the data set. |
| <a name="output_display_name"></a> [display\_name](#output\_display\_name) | The display name of the QuickSight data set. |
| <a name="output_geo_spatial_column_groups"></a> [geo\_spatial\_column\_groups](#output\_geo\_spatial\_column\_groups) | A list of geospatial column groups in the data set. |
| <a name="output_id"></a> [id](#output\_id) | The ID of the data set. |
| <a name="output_import_mode"></a> [import\_mode](#output\_import\_mode) | Whether you want to import the data into SPICE. |
| <a name="output_logical_tables"></a> [logical\_tables](#output\_logical\_tables) | A map of logical table configurations. Each entry represents a logical table in the data set. |
| <a name="output_name"></a> [name](#output\_name) | The identifier of the QuickSight data set. |
| <a name="output_output_columns"></a> [output\_columns](#output\_output\_columns) | The final set of columns available for use in analyses and dashboards after all data preparation and transformation steps have been applied within the dataset. |
| <a name="output_permissions"></a> [permissions](#output\_permissions) | The permissions associated with the QuickSight data set. |
| <a name="output_physical_tables"></a> [physical\_tables](#output\_physical\_tables) | A map of physical table configurations. Each entry represents a physical table in the data set. |
| <a name="output_refresh_config"></a> [refresh\_config](#output\_refresh\_config) | The refresh configuration for the data set. |
| <a name="output_refresh_ingestions"></a> [refresh\_ingestions](#output\_refresh\_ingestions) | A list of refresh ingestions for the data set. |
| <a name="output_refresh_schedules"></a> [refresh\_schedules](#output\_refresh\_schedules) | A list of refresh schedules for the data set. |
| <a name="output_region"></a> [region](#output\_region) | The AWS region this module resources resides in. |
| <a name="output_resource_group"></a> [resource\_group](#output\_resource\_group) | The resource group created to manage resources in this module. |
| <a name="output_row_level_permission_data_set"></a> [row\_level\_permission\_data\_set](#output\_row\_level\_permission\_data\_set) | The row-level permission data set configuration. |
<!-- END_TF_DOCS -->
